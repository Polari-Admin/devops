# ๐ ุชูุฏุฏ (Renew) ฺฏูุงู ฺฉุงุฑุจุฑ ุฏุฑ Kubernetes (`admin.conf`)

ุฏุฑ Kubernetesุ ฺฏูุงูโูุง ฺฉุงุฑุจุฑ ูุงุจู ุชูุฏุฏ ูุณุชูู ูุณุชูุฏุ ุงูุง ูโุชูุงู ฺฏูุงู ุฌุฏุฏ ุจุง **ููุงู ุงุทูุงุนุงุช ูุจู** ุณุงุฎุช ู ุขู ุฑุง ุฌุงฺฏุฒู ฺฉุฑุฏ. ุงู ุนููุงุช ูุนูููุงู ุจุง ุนููุงู "ุฑโุฌูุฑุช" ูุฒ ุดูุงุฎุชู ูโุดูุฏ.

---

## โ ุชูุงูุช ุชูุฏุฏ ู ุฑโุฌูุฑุช

| ุนููุงุช | ุชูุถุญ |
|--------|--------|
| **ุชูุฏุฏ (Renew)** | ุณุงุฎุช ฺฏูุงู ุฌุฏุฏ ุจุง ููุงู ุงุทูุงุนุงุช (CNุ O)ุ ูู ุชุงุฑุฎ ุงููุถุง ุฌุฏุฏ |
| **ุฑโุฌูุฑุช (Regenerate)** | ููฺฉู ุงุณุช ุดุงูู ุณุงุฎุช ฺฉูุฏ ุฎุตูุต ุฌุฏุฏ ูุฒ ุจุงุดุฏ |

---

## โ ูุฑุงุญู ุชูุฏุฏ ฺฏูุงู ุจุง ุญูุธ ฺฉูุฏ ูุจู

### ๐ง ูพุดโูุงุฒ:
- ูุงู ฺฉูุฏ ุฎุตูุต ููุฌูุฏ (`kubernetes-admin.key`)
- ุฏุณุชุฑุณ ุจู CA ุฎูุดู (`ca.crt` ู `ca.key`)

---

### 1. ุณุงุฎุช CSR ุจุง ฺฉูุฏ ูุจู

```bash
openssl req -new -key kubernetes-admin.key \
  -out kubernetes-admin-renewed.csr \
  -subj "/CN=kubernetes-admin/O=system:masters"
```

---

### 2. ุงูุถุง CSR ุจุง CA ุฎูุดู

```bash
openssl x509 -req -in kubernetes-admin-renewed.csr \
  -CA /etc/kubernetes/pki/ca.crt \
  -CAkey /etc/kubernetes/pki/ca.key \
  -CAcreateserial \
  -out kubernetes-admin-renewed.crt \
  -days 365
```

> ๐ ููุฏุงุฑ `-days` ุฑุง ุจุฑ ุงุณุงุณ ูุงุฒ ุชูุธู ฺฉูุฏ.

---

### 3. ุจูโุฑูุฒุฑุณุงู kubeconfig ุจุง ฺฏูุงู ุฌุฏุฏ

```bash
kubectl config set-credentials kubernetes-admin \
  --client-certificate=kubernetes-admin-renewed.crt \
  --client-key=kubernetes-admin.key
```

---

## โ ุฑโุฌูุฑุช ฺฉุงูู (ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ฺฉูุฏ ุฌุฏุฏ)

ุงฺฏุฑ ูโุฎูุงูุฏ ฺฉูุฏ ุฎุตูุต ุฌุฏุฏ ูุฒ ุจุณุงุฒุฏ:

### 1. ุชููุฏ ฺฉูุฏ ุฌุฏุฏ

```bash
openssl genrsa -out kubernetes-admin.key 2048
```

### 2. ุงุฏุงูู ูุฑุงุญู ูุดุงุจู ุจุงูุง (CSR ู ุงูุถุง)

---

## ๐ ูฺฉุงุช ููู ุงููุช

- ฺฏูุงูโูุง ุจุงุฏ ุจุง CA ุฑุณู ุฎูุดู ุงูุถุง ุดููุฏ
- ฺฉูุฏ ุฎุตูุต (`.key`) ุจุณุงุฑ ุญุณุงุณ ุงุณุช โ ููุท ุจู ฺฉุงุฑุจุฑ root ุฏุณุชุฑุณ ุจุฏูุฏ
- ูุงู `admin.conf` ุฑุง ูพุณ ุงุฒ ุฌุงฺฏุฒู ฺฏูุงู ุจุฑุฑุณ ฺฉูุฏ

---

## ๐ง ุงุฏุขูุฑ

`kubeadm` ุจุฑุง node certูุง `kubeadm cert renew` ุฏุงุฑุฏุ ูู ุจุฑุง ฺฉุงุฑุจุฑูุง (client certs) ุจุงุฏ ุฏุณุช ุชูุฏุฏ ุงูุฌุงู ุดูุฏ.

---

ุชููโุดุฏู ุจุง โค๏ธ ุจุฑุง ูุฏุฑุงู ุฎูุดูโูุง Kubernetes